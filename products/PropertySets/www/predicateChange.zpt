<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      tal:omit-tag="">
  <head tal:replace="nothing"><title></title></head>
  <body tal:omit-tag="">
    <h1 tal:replace="structure context/manage_page_header">Header</h1>

    <h2 tal:define="manage_tabs_message request/manage_tabs_message | options/manage_tabs_message | nothing"
        tal:replace="structure context/manage_tabs">Tabs</h2>

    <h3 tal:define="form_title string:Change Predicate Constraints"
        tal:replace="structure context/manage_form_title">
      Form Title
    </h3>

    <p class="form-help">

      Property Set Predicates allow you to extend existing objects
      so that they expose more information through Highly Dynamic
      PropertySheets, also enabling you to query those properties
      through WebDAV PROPFIND.
    </p>

    <p class="form-help">
      <b>Permission</b> to be evaluated using the object as context,
      to decide if a predicate is visible for the current user on
      the current object or not.
    </p>

    <p class="form-help">
      <b>Condition</b> here, is a TALES expression to be evaluated
      when deciding if the PropertySheet should be applied to
      the given object. If you used Page Templates before, those
      expressions are very similar to Page Template expressions.
      The variables available for building the
      expression are: <b>object_url, object, nothing, user, modules, request</b>
    </p>
    <p class="form-help">
      <b>Example: </b>

      <pre>
        python: object.meta_type == 'Document'
      </pre>

    </p>

    <form action="manage_changePredicate"
          method="post"
          enctype="multipart/form-data"
          tal:attributes="action string:${request/URL1}/manage_changePredicate">
      <table cellspacing="0" cellpadding="2" border="0">
        <tr>
          <td align="left" valign="top">
            <div class="form-label">
              Permission
            </div>
          </td>
          <td align="left" valign="top"
              tal:define="default_perm context/getPermission;
                          product context/manage_addProduct/PropertySets">
            <select name="permission:ignore_empty">
              <option tal:repeat="perm product/manage_possiblePermissions"
                      tal:attributes="value perm;
                                      selected python:perm == default_perm and 'selected' or None"
                      tal:content="perm">
                Permission
              </option>
            </select>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top">
            <div class="form-label">
              Condition
            </div>
          </td>
          <td align="left" valign="top">
            <input type="text"
                   name="expression:ignore_empty"
                   size="45"
                   tal:attributes="value context/getExpression"
                   />
          </td>
        </tr>
        <tr>
          <td align="left" valign="top">
          </td>
          <td align="left" valign="top">
            <div class="form-element">
              <input class="form-element"
                     type="submit"
                     name="submit"
                     value=" Save " />
            </div>
          </td>
        </tr>
      </table>
    </form>

    <h1 tal:replace="structure context/manage_page_footer">Footer</h1>
  </body>
</html>
